<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FleetFlow Trips</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />

  <style>
    /* Navbar theme */
    .navbar {
      background-color: #fd7e14 !important;
    }
    .navbar .nav-link.active {
      font-weight: bold;
      text-decoration: underline;
    }

    /* Card headers */
    .card-title {
      color: #fd7e14;
      font-weight: bold;
    }

    /* Buttons */
    .btn-primary {
      background-color: #fd7e14;
      border-color: #fd7e14;
    }
    .btn-primary:hover {
      background-color: #ffc107;
      border-color: #ffc107;
      color: #000;
    }

    /* Table hover effect */
    table tbody tr:hover {
      background-color: #fff3e0;
      transition: 0.3s;
    }

    /* Input group icons */
    .input-group-text {
      border: none;
    }
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
      <a class="navbar-brand text-white" href="{{ url_for('dashboard') }}">FleetFlow</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('dashboard') }}">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('vehicles_page') }}">Vehicles</a></li>
          <li class="nav-item"><a class="nav-link active text-white" href="{{ url_for('trips_page') }}">Trips</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('maintenance_page') }}">Maintenance</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('expenses_page') }}">Expenses</a></li>
        </ul>
      </div>
    </div>
  </nav>
<!-- FLASH MESSAGES -->
{% with messages = get_flashed_messages() %}
  {% if messages %}
    <div class="alert alert-warning alert-dismissible fade show mt-3 mx-auto" style="max-width:500px;" role="alert">
      {{ messages[0] }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endif %}
{% endwith %}
  <!-- Main Container -->
  <div class="container my-5">
    <h2 class="mb-4" style="color:#fd7e14;">Trip Dispatcher & Management</h2>
   

    <!-- Trip Assignment Form -->
    <div class="card shadow-sm p-4 mb-5">
      <h5 class="card-title">Assign a Trip</h5>
      <form id="tripForm" method="POST" action="{{ url_for('add_trip') }}">
        <!-- Vehicle Select -->
        <div class="mb-3 input-group">
          <span class="input-group-text bg-warning text-white"><i class="fa fa-truck"></i></span>
          <select name="vehicle" id="vehicleSelect" class="form-select" required>
            <option value="">Select Vehicle</option>
            {% for vehicle in vehicles %}
              <option value="{{ vehicle.id }}">{{ vehicle.name }} ({{ vehicle.license_plate }})</option>
            {% endfor %}
          </select>
        </div>

        <!-- Driver Select -->
        <div class="mb-3 input-group">
          <span class="input-group-text bg-success text-white"><i class="fa fa-user"></i></span>
          <select name="driver" id="driverSelect" class="form-select" required>
            <option value="">Select Driver</option>
            {% for driver in drivers %}
              <option value="{{ driver }}">{{ driver }}</option>
            {% endfor %}
          </select>
        </div>

        <!-- Cargo Weight -->
        <div class="mb-3 input-group">
          <span class="input-group-text bg-primary text-white"><i class="fa fa-box"></i></span>
          <input type="number" name="cargo_weight" id="cargoWeight" class="form-control" placeholder="Cargo Weight (kg)" min="0" required />
        </div>

        <button type="submit" class="btn btn-primary w-100">
          <i class="fa fa-paper-plane me-2"></i>Assign Trip
        </button>
      </form>
    </div>
    <div class="container my-5">

  <!-- Assigned Trips Table -->
  <div class="card mt-3 shadow-sm">
    <div class="card-body">
      <h5 class="card-title">Assigned Trips</h5>
      <div class="table-responsive">
        <table class="table table-hover align-middle text-center">
          <thead class="table-light">
            <tr>
              <th>Vehicle</th>
              <th>Driver</th>
              <th>Cargo (kg)</th>
              <th>Date Assigned</th>
            </tr>
          </thead>
          <tbody id="tripsTableBody">
            {% for trip in trips %}
              <tr>
                <td>{{ trip.vehicle.name }} ({{ trip.vehicle.license_plate }})</td>
                <td>{{ trip.driver }}</td>
                <td>{{ trip.cargo_weight }}</td>
                <td>{{ trip.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>




</div>
    
  </div>

  <!-- Bootstrap & Font Awesome JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>
  <!-- Custom JS -->
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>